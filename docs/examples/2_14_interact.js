import JsonData from '../../build/contracts/ZombieFactory.json'

/**
 * ABI
 * - abi generated by the compiler
 * - 由编译器生成的 abi
 */
const abi = JsonData.abi
/**
 * 合约抽象
 */
const ZombieFeedingContract = web3.eth.contract(abi)
/**
 * 合约地址
 * - our contract address on Ethereum after deploying
 * - 部署到以太坊后我们的合约地址
 */
const contractAddress = '...'
/**
 * 合约实例
 */
const ZombieFeeding = ZombieFeedingContract.at(contractAddress)

/**
 * 僵尸 ID
 */
const zombieId = 1
/**
 * 将要攻击的猫咪 ID
 */
const kittyId = 1

/**
 * 获取 Kitty 信息的 API 地址
 * - 有关 Kitty 保存在它们的服务器上，而非区块链上。
 */
const kittyApiUrl = 'https://api.cryptokitties.co/kitties/' + kittyId

$.get(kittyApiUrl, (data) => {
  // 获取 kitty 图片
  const imgUrl = data.image_url
  // ... 一些显示图片的代码
})

// 当点击一只 kitty 时：
$('.kittyImage').click((event) => {
  // 调用合约的 feedOnKitty() 函数
  ZombieFeeding.feedOnKitty(zombieId, kittyId)
})

// 监听合约的新增僵尸事件
ZombieFeeding.NewZombie((error, result) => {
  if (error) return

  // 调用显示僵尸方法
  generateZombie(result.zombieId, result.name, result.dna)
})
